/* File: Data.cs
** Project: MusicTheory
** Author: Jeffrey Martin
**
** This file contains the implementation of the Data class.
**
** Copyright © 2021 by Jeffrey Martin. All rights reserved.
** Email: jmartin@jeffreymartincomposer.com
** Website: https://jeffreymartincomposer.com
**
******************************************************************************
**
** This program is free software: you can redistribute it and/or modify
** it under the terms of the GNU General Public License as published by
** the Free Software Foundation, either version 3 of the License, or
** (at your option) any later version.
**
** This program is distributed in the hope that it will be useful,
** but WITHOUT ANY WARRANTY; without even the implied warranty of
** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
** GNU General Public License for more details.
**
** You should have received a copy of the GNU General Public License
** along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

using System.Collections.Generic;

namespace MusicTheory
{
    /// <summary>
    /// Holds important data for use with atonal theory
    /// </summary>
    public static class Functions
    {
        static string[] _noteNamesFlat = new string[] { "C♮", "D♭", "D♮", "E♭", "E♮", "F♮", "G♭", "G♮", "A♭", "A♮", "B♭", "B♮" };
        static string[] _noteNamesSharp = new string[] { "C♮", "C♯", "D♮", "D♯", "E♮", "F♮", "F♯", "G♮", "G♯", "A♮", "A♯", "B♮" };
        static char[] _hexChars = new char[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };

        /// <summary>
        /// Gets hexadecimal characters for a specific number
        /// </summary>
        public static char[] HexChars { get { return _hexChars; } }

        /// <summary>
        /// Note names for flat notes
        /// </summary>
        public static string[] NoteNamesFlat { get { return _noteNamesFlat; } }
        
        /// <summary>
        /// Note names for sharp notes
        /// </summary>
        public static string[] NoteNamesSharp { get { return _noteNamesSharp; } }

        // The Forte name table (after Straus and Morris)
        private static string[,] _forteNameArray = new string[223, 2]
        {
            {"0", "1-1" },
            {"01", "2-1" },
            {"02", "2-2" },
            {"03", "2-3" },
            {"04", "2-4" },
            {"05", "2-5" },
            {"06", "2-6" },
            {"012", "3-1" },
            {"013", "3-2" },
            {"014", "3-3" },
            {"015", "3-4" },
            {"016", "3-5" },
            {"024", "3-6" },
            {"025", "3-7" },
            {"026", "3-8" },
            {"027", "3-9" },
            {"036", "3-10" },
            {"037", "3-11" },
            {"048", "3-12" },
            {"0123", "4-1" },
            {"0124", "4-2" },
            {"0125", "4-4" },
            {"0126", "4-5" },
            {"0127", "4-6" },
            {"0134", "4-3" },
            {"0135", "4-11" },
            {"0136", "4-13" },
            {"0137", "4-Z29" },
            {"0145", "4-7" },
            {"0146", "4-Z15" },
            {"0147", "4-18" },
            {"0148", "4-19" },
            {"0156", "4-8" },
            {"0157", "4-16" },
            {"0158", "4-20" },
            {"0167", "4-9" },
            {"0235", "4-10" },
            {"0236", "4-12" },
            {"0237", "4-14" },
            {"0246", "4-21" },
            {"0247", "4-22" },
            {"0248", "4-24" },
            {"0257", "4-23" },
            {"0258", "4-27" },
            {"0268", "4-25" },
            {"0347", "4-17" },
            {"0358", "4-26" },
            {"0369", "4-28" },
            {"01234", "5-1" },
            {"01235", "5-2" },
            {"01236", "5-4" },
            {"01237", "5-5" },
            {"01245", "5-3" },
            {"01246", "5-9" },
            {"01247", "5-Z36" },
            {"01248", "5-13" },
            {"01256", "5-6" },
            {"01257", "5-14" },
            {"01258", "5-Z38" },
            {"01267", "5-7" },
            {"01268", "5-15" },
            {"01346", "5-10" },
            {"01347", "5-16" },
            {"01348", "5-Z17" },
            {"01356", "5-Z12" },
            {"01357", "5-24" },
            {"01358", "5-27" },
            {"01367", "5-19" },
            {"01368", "5-29" },
            {"01369", "5-31" },
            {"01457", "5-Z18" },
            {"01458", "5-21" },
            {"01468", "5-30" },
            {"01469", "5-32" },
            {"01478", "5-22" },
            {"01568", "5-20" },
            {"02346", "5-8" },
            {"02347", "5-11" },
            {"02357", "5-23" },
            {"02358", "5-25" },
            {"02368", "5-28" },
            {"02458", "5-26" },
            {"02468", "5-33" },
            {"02469", "5-34" },
            {"02479", "5-35" },
            {"03458", "5-Z37" },
            {"012345", "6-1" },
            {"012346", "6-2" },
            {"012347", "6-Z36" },
            {"012348", "6-Z37" },
            {"012357", "6-9" },
            {"012358", "6-Z40" },
            {"012367", "6-5" },
            {"012368", "6-Z41" },
            {"012369", "6-Z42" },
            {"012378", "6-Z38" },
            {"012458", "6-15" },
            {"012468", "6-22" },
            {"012469", "6-Z46" },
            {"012478", "6-Z17" },
            {"012579", "6-Z48" },
            {"012569", "6-Z44" },
            {"012578", "6-18" },
            {"012678", "6-7" },
            {"013457", "6-Z10" },
            {"013458", "6-14" },
            {"013469", "6-27" },
            {"013479", "6-Z49" },
            {"013579", "6-34" },
            {"013679", "6-30" },
            {"023679", "6-Z29" },
            {"014568", "6-16" },
            {"014579", "6-31" },
            {"014589", "6-20" },
            {"023457", "6-8" },
            {"023468", "6-21" },
            {"023469", "6-Z45" },
            {"023579", "6-33" },
            {"024579", "6-32" },
            {"02468A", "6-35" },
            {"012356", "6-Z3" },
            {"012456", "6-Z4" },
            {"012457", "6-Z11" },
            {"012467", "6-Z12" },
            {"012479", "6-Z47" },
            {"013467", "6-Z13" },
            {"012567", "6-Z6" },
            {"013468", "6-Z24" },
            {"012568", "6-Z43" },
            {"013568", "6-Z25" },
            {"013478", "6-Z19" },
            {"013578", "6-Z26" },
            {"023458", "6-Z39" },
            {"013569", "6-Z28" },
            {"014679", "6-Z50" },
            {"023568", "6-Z23" },
            {"0123456", "7-1" },
            {"0123457", "7-2"},
            {"0123467", "7-4" },
            {"0123567", "7-5" },
            {"0123458", "7-3" },
            {"0123468", "7-9" },
            {"0123568", "7-Z36" },
            {"0124568", "7-13" },
            {"0123478", "7-6" },
            {"0123578", "7-14" },
            {"0124578", "7-Z38" },
            {"0123678", "7-7" },
            {"0124678", "7-15" },
            {"0123469", "7-10" },
            {"0123569", "7-16" },
            {"0124569", "7-Z17" },
            {"0123479", "7-Z12" },
            {"0123579", "7-24" },
            {"0124579", "7-27" },
            {"0123679", "7-19" },
            {"0124679", "7-29" },
            {"0134679", "7-31" },
            {"0145679", "7-Z18" },
            {"0124589", "7-21" },
            {"0124689", "7-30" },
            {"0134689", "7-32" },
            {"0125689", "7-22" },
            {"0125679", "7-20" },
            {"0234568", "7-8" },
            {"0134568", "7-11" },
            {"0234579", "7-23" },
            {"0234679", "7-25" },
            {"0135679", "7-28" },
            {"0134579", "7-26" },
            {"012468A", "7-33" },
            {"013468A", "7-34" },
            {"013568A", "7-35" },
            {"0134578", "7-Z37" },
            {"01234567", "8-1" },
            {"01234568", "8-2" },
            {"01234578", "8-4" },
            {"01234678", "8-5" },
            {"01235678", "8-6" },
            {"01234569", "8-3" },
            {"01234579", "8-11" },
            {"01234679", "8-13" },
            {"01235679", "8-Z29" },
            {"01234589", "8-7" },
            {"01234689", "8-Z15" },
            {"01235689", "8-18" },
            {"01245689", "8-19" },
            {"01234789", "8-8" },
            {"01235789", "8-16" },
            {"01245789", "8-20" },
            {"01236789", "8-9" },
            {"02345679", "8-10" },
            {"01345679", "8-12" },
            {"01245679", "8-14" },
            {"0123468A", "8-21" },
            {"0123568A", "8-22" },
            {"0124568A", "8-24" },
            {"0123578A", "8-23" },
            {"0124578A", "8-27" },
            {"0124678A", "8-25" },
            {"01345689", "8-17" },
            {"0134578A", "8-26" },
            {"0134679A", "8-28" },
            {"012345678", "9-1" },
            {"012345679", "9-2" },
            {"012345689", "9-3" },
            {"012345789", "9-4" },
            {"012346789", "9-5" },
            {"01234568A", "9-6" },
            {"01234578A", "9-7" },
            {"01234678A", "9-8" },
            {"01235678A", "9-9" },
            {"01234679A", "9-10" },
            {"01235679A", "9-11" },
            {"01245689A", "9-12" },
            {"0123456789", "10-1" },
            {"012345678A", "10-2" },
            {"012345679A", "10-3" },
            {"012345689A", "10-4" },
            {"012345789A", "10-5" },
            {"012346789A", "10-6" },
            {"0123456789A", "11-1" },
            {"0123456789AB", "12-1" }
        };

        // The Z-relation table
        private static string[,] _zNameArray = new string[46, 2]
        {
            {"4-Z15", "4-Z29" },
            {"4-Z29", "4-Z15" },
            {"5-Z12", "5-Z36" },
            {"5-Z17", "5-Z37" },
            {"5-Z18", "5-Z38" },
            {"5-Z36", "5-Z12" },
            {"5-Z37", "5-Z17" },
            {"5-Z38", "5-Z18" },
            {"6-Z3", "6-Z36" },
            {"6-Z4", "6-Z37" },
            {"6-Z6", "6-Z38" },
            {"6-Z10", "6-Z39" },
            {"6-Z11", "6-Z40" },
            {"6-Z12", "6-Z41" },
            {"6-Z13", "6-Z42" },
            {"6-Z17", "6-Z43" },
            {"6-Z19", "6-Z44" },
            {"6-Z23", "6-Z45" },
            {"6-Z24", "6-Z46" },
            {"6-Z25", "6-Z47" },
            {"6-Z26", "6-Z48" },
            {"6-Z28", "6-Z49" },
            {"6-Z29", "6-Z50" },
            {"6-Z36", "6-Z3" },
            {"6-Z37", "6-Z4" },
            {"6-Z38", "6-Z6" },
            {"6-Z39", "6-Z10" },
            {"6-Z40", "6-Z11" },
            {"6-Z41", "6-Z12" },
            {"6-Z42", "6-Z13" },
            {"6-Z43", "6-Z17" },
            {"6-Z44", "6-Z19" },
            {"6-Z45", "6-Z23" },
            {"6-Z46", "6-Z24" },
            {"6-Z47", "6-Z25" },
            {"6-Z48", "6-Z26" },
            {"6-Z49", "6-Z28" },
            {"6-Z50", "6-Z29" },
            {"7-Z12", "7-Z36" },
            {"7-Z17", "7-Z37" },
            {"7-Z18", "7-Z38" },
            {"7-Z36", "7-Z12" },
            {"7-Z37", "7-Z17" },
            {"7-Z38", "7-Z18" },
            {"8-Z15", "8-Z29" },
            {"8-Z29", "8-Z15" }
        };

        // The Carter name table
        private static string[,] _carterNameArray = new string[220, 2]
        {
            {"2-1", "1"},
            {"2-2", "2"},
            {"2-3", "3"},
            {"2-4", "4"},
            {"2-5", "5"},
            {"2-6", "6"},
            {"3-1", "4"},
            {"3-2", "12"},
            {"3-3", "11"},
            {"3-4", "9"},
            {"3-5", "7"},
            {"3-6", "3"},
            {"3-7", "10"},
            {"3-8", "8"},
            {"3-9", "5"},
            {"3-10", "2"},
            {"3-11", "6"},
            {"3-12", "1"},
            {"4-1", "1"},
            {"4-2", "17"},
            {"4-3", "9"},
            {"4-4", "20"},
            {"4-5", "22"},
            {"4-6", "6"},
            {"4-7", "8"},
            {"4-8", "10"},
            {"4-9", "2"},
            {"4-10", "3"},
            {"4-11", "26"},
            {"4-12", "28"},
            {"4-13", "7"},
            {"4-14", "25"},
            {"4-Z15", "18"},
            {"4-16", "19"},
            {"4-17", "13"},
            {"4-18", "21"},
            {"4-19", "24"},
            {"4-20", "15"},
            {"4-21", "11"},
            {"4-22", "27"},
            {"4-23", "4"},
            {"4-24", "16"},
            {"4-25", "12"},
            {"4-26", "14"},
            {"4-27", "29"},
            {"4-28", "5"},
            {"4-Z29", "23"},
            {"5-1", "1"},
            {"5-2", "11"},
            {"5-3", "14"},
            {"5-4", "12"},
            {"5-5", "13"},
            {"5-6", "27"},
            {"5-7", "30"},
            {"5-8", "2"},
            {"5-9", "15"},
            {"5-10", "19"},
            {"5-11", "18"},
            {"5-Z12", "5"},
            {"5-13", "17"},
            {"5-14", "28"},
            {"5-15", "4"},
            {"5-16", "20"},
            {"5-Z17", "10"},
            {"5-Z18", "35"},
            {"5-19", "31"},
            {"5-20", "34"},
            {"5-21", "21"},
            {"5-22", "8"},
            {"5-23", "25"},
            {"5-24", "22"},
            {"5-25", "24"},
            {"5-26", "26"},
            {"5-27", "23"},
            {"5-28", "36"},
            {"5-29", "32"},
            {"5-30", "37"},
            {"5-31", "33"},
            {"5-32", "38"},
            {"5-33", "6"},
            {"5-34", "9"},
            {"5-35", "7"},
            {"5-Z36", "16"},
            {"5-Z37", "3"},
            {"5-Z38", "29"},
            {"6-1", "4"},
            {"6-2", "19"},
            {"6-Z3", "49"},
            {"6-Z4", "24"},
            {"6-5", "16"},
            {"6-Z6", "33"},
            {"6-7", "7"},
            {"6-8", "5"},
            {"6-9", "20"},
            {"6-Z10", "42"},
            {"6-Z11", "47"},
            {"6-Z12", "46"},
            {"6-Z13", "29"},
            {"6-14", "3"},
            {"6-15", "13"},
            {"6-16", "11"},
            {"6-Z17", "35"},
            {"6-18", "17"},
            {"6-Z19", "37"},
            {"6-20", "2"},
            {"6-21", "12"},
            {"6-22", "10"},
            {"6-Z23", "27"},
            {"6-Z24", "39"},
            {"6-Z25", "43"},
            {"6-Z26", "26"},
            {"6-27", "14"},
            {"6-Z28", "21"},
            {"6-Z29", "32"},
            {"6-30", "15"},
            {"6-31", "8"},
            {"6-32", "6"},
            {"6-33", "18"},
            {"6-34", "9"},
            {"6-35", "1"},
            {"6-Z36", "50"},
            {"6-Z37", "23"},
            {"6-Z38", "34"},
            {"6-Z39", "41"},
            {"6-Z40", "48"},
            {"6-Z41", "45"},
            {"6-Z42", "30"},
            {"6-Z43", "36"},
            {"6-Z44", "38"},
            {"6-Z45", "28"},
            {"6-Z46", "40"},
            {"6-Z47", "44"},
            {"6-Z48", "25"},
            {"6-Z49", "22"},
            {"6-Z50", "31"},
            {"7-1", "1"},
            {"7-2", "11"},
            {"7-3", "14"},
            {"7-4", "12"},
            {"7-5", "13"},
            {"7-6", "27"},
            {"7-7", "30"},
            {"7-8", "2"},
            {"7-9", "15"},
            {"7-10", "19"},
            {"7-11", "18"},
            {"7-Z12", "5"},
            {"7-13", "17"},
            {"7-14", "28"},
            {"7-15", "4"},
            {"7-16", "20"},
            {"7-Z17", "10"},
            {"7-Z18", "35"},
            {"7-19", "31"},
            {"7-20", "34"},
            {"7-21", "21"},
            {"7-22", "8"},
            {"7-23", "25"},
            {"7-24", "22"},
            {"7-25", "24"},
            {"7-26", "26"},
            {"7-27", "23"},
            {"7-28", "36"},
            {"7-29", "32"},
            {"7-30", "37"},
            {"7-31", "33"},
            {"7-32", "38"},
            {"7-33", "6"},
            {"7-34", "9"},
            {"7-35", "7"},
            {"7-Z36", "16"},
            {"7-Z37", "3"},
            {"7-Z38", "29"},
            {"8-1", "1"},
            {"8-2", "17"},
            {"8-3", "9"},
            {"8-4", "20"},
            {"8-5", "22"},
            {"8-6", "6"},
            {"8-7", "8"},
            {"8-8", "10"},
            {"8-9", "2"},
            {"8-10", "3"},
            {"8-11", "26"},
            {"8-12", "28"},
            {"8-13", "7"},
            {"8-14", "25"},
            {"8-Z15", "18"},
            {"8-16", "19"},
            {"8-17", "13"},
            {"8-18", "21"},
            {"8-19", "24"},
            {"8-20", "15"},
            {"8-21", "11"},
            {"8-22", "27"},
            {"8-23", "4"},
            {"8-24", "16"},
            {"8-25", "12"},
            {"8-26", "14"},
            {"8-27", "29"},
            {"8-28", "5"},
            {"8-Z29", "23"},
            {"9-1", "4"},
            {"9-2", "12"},
            {"9-3", "11"},
            {"9-4", "9"},
            {"9-5", "7"},
            {"9-6", "3"},
            {"9-7", "10"},
            {"9-8", "8"},
            {"9-9", "5"},
            {"9-10", "2"},
            {"9-11", "6"},
            {"9-12", "1"},
            {"10-1", "1"},
            {"10-2", "2"},
            {"10-3", "3"},
            {"10-4", "4"},
            {"10-5", "5"},
            {"10-6", "6"}
        };

        /// <summary>
        /// Generates a collection of tables for Set
        /// </summary>
        /// <returns>An array of tables</returns>
        public static Dictionary<string, string>[] GenerateSetTables()
        {
            Dictionary<string, string>[] tables = new Dictionary<string, string>[4];
            for (int i = 0; i < 4; i++)
                tables[i] = new Dictionary<string, string>();
            for (int i = 0; i < _forteNameArray.GetLength(0); i++)
            {
                tables[0].Add(_forteNameArray[i, 0], _forteNameArray[i, 1]);
                tables[1].Add(_forteNameArray[i, 1], _forteNameArray[i, 0]);
            }
            for (int i = 0; i < _carterNameArray.GetLength(0); i++)
            {
                tables[2].Add(_carterNameArray[i, 0], _carterNameArray[i, 1]);
            }
            for (int i = 0; i < _zNameArray.GetLength(0); i++)
                tables[3].Add(_zNameArray[i, 0], _zNameArray[i, 1]);
            return tables;
        }
    }
}
